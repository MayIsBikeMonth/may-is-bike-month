<%# NOTE: THIS IS ONLY FOR Admin Views right now %>

<%# NOTE: when you add new search_ params here, also add it to hidden_search_fields %>
<% viewing ||= controller_name.humanize %>
<% cheader_keys = %w[user current_competition] %>
<% include_competition_select ||= false %>
<% header_present ||= (cheader_keys & params.keys).any? || include_competition_select %>

<% if header_present %>
  <div class="mb-6" data-controller="admin-current-header">
    <% skip_topics ||= false %>
    <% if user_subject.present? %>
      <p class="mb-2">
        <%= viewing %> for
        <strong><%= link_to user_subject.username, edit_admin_user_path(user_subject) %></strong>
        <em class="less-strong">
          &ndash; view <%= viewing.downcase %> for
          <%= link_to "all users", url_for(sortable_params.merge(user: nil)) %>
        </em>
      </p>
    <% end %>
    <% if current_competition.present? || include_competition_select %>
      <p class="mb-2">
        <%= viewing %> for competition:
        <strong><%= current_competition.display_name %></strong>
        <em class="less-strong">
          &ndash; view <%= viewing.downcase %> for
          <% if @searchable_competitions.present? %>
            <%= select_tag :search_competition_id, options_for_select(@searchable_competitions.map { |s| [s.humanize, s] }, selected: competition_subject), class: "form-control-inline updateOnChange mx-1", "data-updateUrl" => url_for(sortable_params.merge(search_competition_id: "UpdateThis")) %>
            <% unless competition_subject.blank? %> or for <% end %>
          <% end %>
          <% if current_competition.blank? %>
            <%= link_to "all competitions", url_for(sortable_params.merge(search_competition: nil)) %>
          <% end %>
        </em>
      </p>
    <% end %>
  </div>
<% end %>

<% render_period ||= false %>
<% total_count ||= collection.total_count %>
<% if render_period %>
  <%= render partial: "/shared/period_select", locals: {total_count: total_count} %>
<% end %>
<% skip_pagination ||= false %>
<% unless skip_pagination %>
  <%# <div class="row mt-4"> %>
    <%=# render partial: "tranzito_utils/pagination", locals: {collection: collection, name: viewing} %>
  <%# </div> %>
<% end %>
